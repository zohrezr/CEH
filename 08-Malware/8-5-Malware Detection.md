$\color{#b91646}{\textsf{Malware Detection}}$
=============================================

چطوری می تونیم تشخیص بدیم که سیستم ما malware داره یا نه؟


## $\color{#105652}{\textsf{check anti virus}}$

**Star with an updated anti virus**

اولی کار اینه که آنتی ویروس به روزرسانی شده رو چک کنیم.

همچنین فایروال هم روشن باشه.

## $\color{#105652}{\textsf{Check below and search for unknowns}}$

پشت یه سیستم که می شینیم چطوری میتونیم متوجه بهشیم state سیستم چیه؟ (طبیعیه یا نه)

### $\color{#25678D}{\textsf{Ports}}$

**Ports (netstat -a -n , tcpview, currports, ...)**

اولین کار اینه که portهارو چک کنیم

`root@kali~# netstat -na`

با این دستور port هایی که listen می کنه (منتظر بهش وصل شن) یا stablish هست (یعنی ارتباط برقراره) و connection هایی که با سیسیتم برقراره رو نشون میده.

توی ویندوز و لینوکس دستور netstat یکیه.

با دستورات tcpview و currports و ... هم می شه دید.

________________

### $\color{#25678D}{\textsf{Processes}}$

**Processes (process monitor)**

دیدن process ها یک قدم مهمه.

در سیستم های لینوکسی با این دستور همه ی process هایی که داره اجرا می شه رو نشون میده.

`root@kali~# ps ef`

توی ویندوز در قسمت system information می تونیم process ها رو ببینیم.

می تونیم در ویندوز با استفاده از task manager نیز process هارو ببینیم.

_______________________________
### $\color{#25678D}{\textsf{Registry Entries}}$

**Registry Entries (is huge! So you will need tools like *jv16*, regscanner)**

در دنیای ویندوز regiter ای هم خیلی مهمه. -> register ای مثل یه database است که برنامه ها می تونن یکسری از دیتاشونو بذارن و بعد بازخوانی کنن.

با استفاده از برنامه های مختلف می تونیم register ای رو ببینیم.

________________________

### $\color{#25678D}{\textsf{Device Drivers}}$

**Device Drivers (msinfo can show drivers or even hide all MS ones (from view))**

خیلی از برنامه هایی که نصب می شن خودشونو به شکل device driver نصب می شن. چون به level های پایین تری دسترسی داره.

با msinfo می تونیم ببینیم چه device هایی توی سیستم دارن اجرا می شن.
__________________
### $\color{#25678D}{\textsf{Services}}$

**Services (msinfo, service manager)**

سرویس ها در واقع چیزهایی که دارن run می شن و می تونن به سیستم ها جواب بدن، یه request رو قبول کنن برگردونن.

از قسمت system information توی ویندوز می تونیم ببینیم.
__________________________
### $\color{#25678D}{\textsf{Startup Apps}}$

**Startup Apps (can start from different places so you can go with this tool: security autorun)**

برنامه هایی که وقتی میان بالا اجرا می شن.

برنامه ای مثل security autorun می تونه این برنامه ها رو توی ویندوز به صورت منطم نشون بده.

_____________________
### $\color{#25678D}{\textsf{Files and folders}}$

**Files and folders (tools like SFC, SIGVERIF & FCIV will save and check hashes. Also there is 3rd party tripwire. sfc /?)**

فایل های و فولدارها رو باید چک کنیم.

در واقع checksum ای از فایل ها حساب می کنن، و هرچند وقت یکبار چک می کنن ببینن فایل های مهم سیستم دست خوردن یا نه

در دنیای ویندوز برنامه ی SFC واسه مایکروسافته و نصب شده -> scan انجام میده 
______________________
### $\color{#25678D}{\textsf{Network Activities}}$

**Network Activities. This happens a lot when you are compromised. Specially if protocol is used unusually (say repeated ICMP with PacketID 0). We will see this more on sniffing.**

با برنامه هایی مثل TCPdump می تونیم یه مدت بذاریم (مثلا یه ساعت) network activity سیستمی که ازش استفاده نمی شه چک بشه و ذخیره بشه توی یه فایل و بعد اونو با wireshark باز کنیم و بعد بررسی کنیم.
