$\color{#b91646}{\textsf{Trojons}}$
=============================================


- **Wrapping malware with legitimate app (binding)**

یه قسمتی توی یه برنامه مخفی شده که کاربر خبر نداره.

دوتا app رو بهم bind کنیم.

- **RAT (remote access trojan)can hide or covert on HTTP, VNC, ICMP, HTTPS, ...; say HTTP RAT but be careful where you download & check md5s**

مهاجم روی سیستم قربانی یه RAT راه می اندازه و دیتاشو به صورت covert یا hide توی دیتای HTTP, VNC, ICMP و ... رد کنم.

- **Firewall will let outbound traffic**

یکسری کامپیوتر توی شبکه داریم یه فایروال هم لبه ی شبکه داریم.

معمولا فایروال تمام ترافیک های از بیرون به داخل شبکه رو می بنده.

یه RAT روی یکی از کامپیوترهای داخل شبکه نصب می کنی. RAT که روی سیستم توی شبکه اجرا شد یه IP بهش می دیم که معمولا IP اون device ماست که اونور شبکه اس و در نهایت ماشینی که روش RAT نصبه وصل می شه به ماشینی که بیرون شبکه اس.

فایروال معمولا با ترافیک خروجی کاری نداره به خصوص اگر covert کنیم -> یعنی اگر توی یه پروتکلی مثل HTTP کل دیتامو بپوشونم، چون port:80 و پروتکل HTTP (همه چیز طبیعیه) در نتیجه فایروال کاری نداره.

یا مثلا ICMP باشه، فایروال فکر می کنه شما دارین بیرون رو ping می کنید ولی در واقع توی پکت ping شما می تونید خیلی چیزا جا بدین و دیتای بیشتری رو منتقل کنید.

  
- **They sometimes use DynamicDNS to keep access in log term.**

سرور RAT بیرون از شبکه اس و یه back door توی یکی از کامپیوترهای شبکه اینجاد می کنیم که دیتا بفرسته به سرور RAT (معمولا فایروال با ترافیک خروجی کاری نداره)

مشکلی که هست همه ی دنیا خیلی سریع می بیینن یه سروری هست که واسه RAT استفاده می شه.

یا وقتی که می خوای بگی به سیستمت وصل شه ممکنه IP عوض شه یا IP رو ببیندن در نتیجه از Dynamic DNS استفاده می کنن.

مثلا یه سایتی هست به اسم DDNS واسط قرار می گیره دیگه وقتی IP ما عوض شد میریم اونجا IP جدید رو بهش می دیم.

یه سرور داریم که یه IP داره. مستقیم IPشو به RAT نمیدیم. مثلا میریم توی سایتی به اسم DDNS، اونجا یکسری free domain داره. 

بعد یکی از domian هارو می گیریم و می گیم IP برابر سرور من است.

توی RAT فقط بهش می گیم وصل شو به domain ای که در DDNS است و اون domain هم به سرور اصلیه.

هر زمان IP عوض شد کافیه توی سایت DDNS فقط DNS رو عوض کنم.

اگر سرورتونو بستن، یه سرور دیگه میارین بالا و دوباره IPشو میده به DDNS


- **Botnets, Proxy Trojons, ...**

- **Show a sample RAT from SEToolkit**

توی کالی یه ابزاری داریم به اسم setoolkit برای درست کردن ابزارهای مهندسی اجتماعی استفاده می شه.

`root@kali~: setoolkit`

سناریو -> می خوایم یه چیزی درست کنیم که اگر روی ویندوز بتونیم یکی رو راضی کنیم اجراش کنه، یه remote access بهمون میده.

امکانات مختلفی داره -> می خوایم RAT درست کنیم گزینه ی Social-Enginireeng Attacks رو انتخاب می کنیم. (برای ویندوز)

بعد نوع attack مورد نظر رو مشخص می کنیم، می خوایم از powershell ویندوز استفاده کنیم و یه remote access درست کنم پس گزینه ی Powershell Attack Vectors رو انتخاب می کنم.

مدل های مختلف powershell رو میاره که ما گزینه ی Powershell Alphanumeric Shellcode Injector رو میاره -> Injector یعنی یه کد به شما میده که alphanumerical است (فقط حروف و اعداد است)

یه کدی به ما میده که اگر توی powershell اجرا شد remote access به ما بده.

از ما IP و port سیستم هدف رو می گیره.

می پرسه listener رو هم بیارم بالا -> باعث می شه زمانی که کد روی سیستم قربانی اجرا شد متوجه بشه

توی کالی مهاجم می تونه session هایی که بهش وصل می شه رو ببینه.

`msf5 exploit(multi/handler) > sessions`

بعد session مورد نظر رو انتخاب کنیم می تونیم command اجرا کنیم.

`msf5 exploit(multi/handler) > sessions -i 1`

`meterpreter > idletime`

دسترسی کامل به shell بگیریم.

`meterpreter > shell` 

`C:\windows\system32 > ls`


**ابزارهای زیادی برای ساخت trojan است. اینجا از کالی استفاده شد.
