$\color{#b91646}{\textsf{HOW}}$
=============================================

## $\color{#105652}{\textsf{Network Layer}}$

در لایه ی network پیچیده تر است.

### $\color{#25678D}{\textsf{TCP/IP}}$

**in you can find the sequence number, you can inject packets; with source IP spoofing or even DOS on main user**


پکت هایی که میرن و برمیگردن یه seq number دارن.

اگر شنود کنی و اون seq number (مثلا seq number=n) رو برداری و بعدا قبل از اینکه قربانی بفرسته، یه پکت بفرستیم که توش seq number درست هست (seq number=n+1) و آدرس هم spoof شده به source قربانی، سرور احتمالا فکر می کنه که این پکت valid است که از سمت قربانی اومده.

در spoof نیازی به seesion id نداریم، فقط داریم یه پکتی بین cominucation قربانی می فرستیم.

یه TCP session درست شده، قربانی داره یه مکالمه ای انجام میده، این وسط مهاجم یه پکت می فرسته و سرور فکر می کنه پکت درستی است.

______________________
### $\color{#25678D}{\textsf{UDP session hijacking}}$

**answering quicker than the server or other ways to trick the victim to think that you are the server**

پکت ها الزاما یه session درست نمی کنن.

قربانی یه چیزی می فرسته و سرور جوابشو میده.

اگر source رو تونسته باشی spoof کنی و جواب سریعتری بدی احتمالا سرور می تونه فکر کنه که پکت اصلی از سمت قربانی اومده.
______________________
### $\color{#25678D}{\textsf{DNS Spoofing}}$

می تونید یک DNS دروغی درست کنید.

در نتیجه اگر کاربر به عنوان یه یوزر می خواد توی یه سایتی لاگین کنه، اگر مهاجم DNS spoof کرده باشه می تونه آدرس سایت رو در اون لحظه به قربانی یه چیز دیگه نشون بده.

توی مرورگر قربانی آدرس سایت درست نوشته شده ولی مهاجم با DNS ترافیک رو منحرف کرده.

با phishing فرق داره -> در phishing آدرس هم اشتباهه کاربر متوجه نشده ولی اینجا آدرس درسته و نمی دونه DNS  دروغ گفته.
__________________________
## $\color{#105652}{\textsf{App Layer}}$

### $\color{#25678D}{\textsf{HTTP. HTTP needs some kind of persistence layer}}$
**cookies, custom URLs, hidden form fields, session ID, token, ... whoever gets this session ID, token, cookie, .. will be known as this URS.**



How to get these? sniffing and resending these, MITM. Referrals
Even bruteforce for session IDs! 
Session Fixation: create the URL with session ID and share
Session Donation: login into the website, create a fake account and share the link with others .. they have logged in so they will use!
XSS. bob logged in on X with cookie. Attacker sends an script to bob. When it is run, it will send a request to site X to download from bobs site using the cookie. Stored vs Reflected.
Also malware, bad extensions, API hooking on exe and dll, ... Sometimes called Man In the Browser
Can come from log files! 
active vs passive (injecting or no)
blind hijack: attacker can not see the result
...
check the Referer in headers, cookies, firesheep


