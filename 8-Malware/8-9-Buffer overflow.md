$\color{#b91646}{\textsf{Buffer overflow}}$
============================================

### $\color{#25678D}{\textsf{What it means}}$


- **malloc and pointers**

وقتی برنامه می نویسید یه دستور دارید به اسم `malloc` که memory رو alocate می کنه به یه کاری.

مثلا می گیم به من 20K مموری بده و بعد توی این 20K هر کاری دوست داریم می کنیم.

- **Stack smashing (overwriting or corrupting the return pointer)**

می تونم return pointer یه چیزی رو خراب کنم.

چون در نهایت اگر میرم توی یه فانکشنی بعدا برنامه هایی مثل C یادش هست باید کجا برگرده. اگر اونجایی که یادش نگه داشته بود یه چیز دیگه ای بنویسم میرم یه جای دیگه.

- **Adding NoP to memory and then jump, just like an airplane sliding on a loooong strip. Kind of padding the memory**


بعد از یوزرنیم که 20 کاراکتر بود بیایم 2000تا NOP بذاریم در نتیجه وقتی میره توی memory یوزرنیم که می شینه 20K می پره جلو و بعد کدی که اونجاست رو اجرا می کنه.
__________________________
### $\color{#25678D}{\textsf{Why}}$

- **DoS + Bypass security + Or even run code (say for opening a port)**

این مدل مشکلات خیلی زیاده و دلیلی که آدما استفاده می کنن اینه که DOS attack می کنن و باعث می شن سرور ها crash کنن.

بعضی وقتا می تونن bypass security کنن.

یا یه مواقعی پیش میاد که کد اجرا می کنن. -> مثلا با همون NOP که گفتیم یه port رو باز می کنن.
_________
### $\color{#25678D}{\textsf{C & C++}}$

- **C & C++ do not automatically check for this.** 

در C و ++C چون خود زبان جلوی این مشکلات رو نمی گیره -> خیلی نسبت به این موضوع ضربه پذیرن

_______________
### $\color{#25678D}{\textsf{strcpy}}$

- **strcpy can copy data into memory**

آدما یه کارای عجیبی می کنن مثلا یه دستوری هست به اسم `strcpy(string1`\string2)` که می تونیم بهش بگیم strcpy کن این string رو توی اون string.

خب string1 یه جایی توی memory ذخیره شده و string2 هم یه جایی توی memory ذخیره شده.

اولیو copy می کنه توی دومی و انتهاش از اون محل memory می زنه بیرون -> یه جایی از memory که قرار نبوده عوض می شه. اون تیکه ای که زده بیرون ممکنه قبلا برنامه ای بوده که اجرا می شده

بعضی وقتا یه برنامه ای رو می نویسی که می گه یوزرنیم رو بپرس و بعد توی memory مشخص می کنی یوزرنیم از نوع کاراکتر است و نهایت 20 تاست (char[20])

و توی memory بعد از این 20 کاراکتر یه چیزایی هست که ممکنه کد باشه.

اگر یکی بیاد یوزرنیمشو به جای 20 تا 80 تا بزنه واقعا بعدا بذارینش توی memory با strcpy یا هر روش دیگه ای اون تیکه ی اضافه میره جایی که نباید و اگر یه زمانی اجرا بشه اون تیکه ای که نباید اجرا می شه.

اگرم نرسه به اون تیکه از memory ممکنه برنامه برسه به جایی و crash کنه.
_________
### $\color{#25678D}{\textsf{code red}}$

- **Check ‘code red’**

یه worm بود باعث می شد سرور از کار بیفته.
______________
### $\color{#25678D}{\textsf{prevent}}$

- **IDS/IPS on Host**
- **writing good code with boundary validation**
- **having cookies (canary value) in memory and checking them**
- **stack guard (saving return values and checking them)** 
- **using tools like splint (checks for BO possibilities)**
- **logs**

_________________
### $\color{#25678D}{\textsf{On hardware level}}$

- **On hardware level, there are NX (no exec) or XD (exec disabled) flags for memory**

می تونیم یه تیکه از memory رو فقط به عنوان memory ازش استفاده کرد -> execution disable است
______________
### $\color{#25678D}{\textsf{heartbleed}}$

می تونستین باهاش توی shell دسترسی root بگیرین.
